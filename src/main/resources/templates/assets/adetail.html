<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="/static/css/item/layui.css">
    <link rel="stylesheet" href="/static/css/weadmin.css">
    <style>
        #model .we-search input.layui-input {
            width: 154px;
        }
    </style>
</head>

<!--详情的弹窗-->
<div id="detailsWindow" style="display: none;margin-top: 1%;">

    <form class="layui-form" style="color: #666;" id="adetailform">

        <div id="tdetail">
            <div class="layui-form-item">
                <label for="assetsId" class="layui-form-label">
                    资产编号
                </label>
                <div class="layui-input-inline">
                    <input readonly  type="text" id="assetsId" name="assetsId" autocomplete="off" class="layui-input">
                </div>

                <label for="assetsName" class="layui-form-label">
                    资产名称
                </label>
                <div class="layui-input-inline">
                    <input readonly type="text" id="assetsName" name="assetsName" autocomplete="off" class="layui-input">
                </div>

                <label for="assetsNormtype" class="layui-form-label">
                    规格型号
                </label>
                <div class="layui-input-inline">
                    <input readonly type="text" id="assetsNormtype" name="assetsNormtype" autocomplete="off" class="layui-input">
                </div>
            </div>

            <div class="layui-form-item">
                <label for="assetsFactory" class="layui-form-label">
                    生产厂家
                </label>
                <div class="layui-input-inline">
                    <input type="text" id="assetsFactory" name="assetsFactory" autocomplete="off" class="layui-input">
                </div>

                <label for="assetsBuytime" class="layui-form-label">
                    购买日期
                </label>
                <div class="layui-input-inline">
                    <input type="text" id="assetsBuytime" name="assetsBuytime" autocomplete="off" class="layui-input">
                </div>

                <label for="assetsNum" class="layui-form-label">
                    购买数量
                </label>
                <div class="layui-input-inline">
                    <input readonly type="text" id="assetsNum" name="assetsNum" autocomplete="off" class="layui-input">
                </div>
            </div>

            <div class="layui-form-item">
                <label  for="assetsUnivalent" class="layui-form-label">
                    资产单价
                </label>
                <div class="layui-input-inline">
                    <input readonly type="text" id="assetsUnivalent" name="assetsUnivalent" autocomplete="off" class="layui-input">
                </div>

                <label for="assetsAllAmount" class="layui-form-label">
                    资产总额
                </label>
                <div class="layui-input-inline">
                    <input readonly type="text" id="assetsAllAmount" name="assetsAllAmount" autocomplete="off" class="layui-input">
                </div>

                <label for="assetInitialval" class="layui-form-label">
                    资产原值
                </label>
                <div class="layui-input-inline">
                    <input readonly type="text" id="assetInitialval" name="assetInitialval" autocomplete="off" class="layui-input">
                </div>
            </div>

            <div class="layui-form-item">
                <label  for="assetsAddway" class="layui-form-label">
                    增加方式
                </label>
                <div class="layui-input-inline">
                    <input readonly type="text" id="assetsAddway" name="assetsAddway" autocomplete="off" class="layui-input">
                </div>

                <label for="assetsStateName" class="layui-form-label">
                    资产状态
                </label>
                <div class="layui-input-inline">
                    <input readonly type="text" id="assetsStateName" name="assetsStateName" autocomplete="off" class="layui-input">
                </div>

                <label for="assetsOutfactoryTime" class="layui-form-label">
                    出厂日期
                </label>
                <div class="layui-input-inline">
                    <input readonly type="text" id="assetsOutfactoryTime" name="assetsOutfactoryTime" autocomplete="off" class="layui-input">
                </div>
            </div>

            <div class="layui-form-item">
                <label for="depWay"  class="layui-form-label">
                    折旧方式
                </label>
                <div class="layui-input-inline">
                    <input  type="text" readonly id="depWay" name="depWay" autocomplete="off" class="layui-input">
                </div>

                <label for="depMonthnum" class="layui-form-label">
                    折旧月数
                </label>
                <div class="layui-input-inline">
                    <input  type="text" readonly id="depMonthnum" name="depMonthnum" autocomplete="off" class="layui-input">
                </div>

                <label for="carryMonthnum" class="layui-form-label">
                    已提月数
                </label>
                <div class="layui-input-inline">
                    <input  type="text" readonly id="carryMonthnum" name="carryMonthnum" autocomplete="off" class="layui-input">
                </div>

            </div>

            <div class="layui-form-item">
                <label for="exceptNetval" class="layui-form-label">
                    预计残净值
                </label>
                <div class="layui-input-inline">
                    <input  type="text" readonly id="exceptNetval" name="exceptNetval" autocomplete="off" class="layui-input">
                </div>

                <label for="depAll" class="layui-form-label">
                    累计折旧
                </label>
                <div class="layui-input-inline">
                    <input  type="text" readonly id="depAll" name="depAll" autocomplete="off" class="layui-input">
                </div>

                <label for="storageLocation" class="layui-form-label">
                    存储地
                </label>
                <div class="layui-input-inline">
                    <input  type="text" readonly id="storageLocation" name="storageLocation" autocomplete="off" class="layui-input">
                </div>


            </div>

            <div class="layui-form-item">
                <label for="deptUse" class="layui-form-label">
                    使用部门
                </label>
                <div class="layui-input-inline">
                    <input  type="text" readonly id="deptUse" name="deptUse" autocomplete="off" class="layui-input">
                </div>

                <label for="assetsType" class="layui-form-label">
                    资产类型
                </label>
                <div class="layui-input-inline">
                    <input type="text" id="assetsType" name="assetsType" autocomplete="off" class="layui-input">
                </div>

                <label for="depMothly" class="layui-form-label">
                    资产类型
                </label>
                <div class="layui-input-inline">
                    <input type="text" id="depMothly" name="depMothly" autocomplete="off" class="layui-input">
                </div>

            </div>

            <div class="layui-form-item" style="width: 50%">
                <label for="assetsRemark" class="layui-form-label">
                    补充说明
                </label>
                <div class="layui-input-block">
                    <textarea  type="text" readonly id="assetsRemark" name="assetsRemark" autocomplete="off" class="layui-textarea"></textarea>
                </div>

            </div>
        </div>
    </form>

</div>
<body>

    <div class="weadmin-body">
        <div class="layui-row" id="model">
            <form class="layui-form we-search" style="color: #666;">
                资产编号：
                <div class="layui-inline">
                    <input type="text" name="aId" id="aId" placeholder="" autocomplete="off" class="layui-input">
                </div>
                资产名称：
                <div class="layui-inline">
                    <input type="text" name="aName" id="aName" placeholder="" autocomplete="off" class="layui-input">
                </div>

                资产类型：
                <div class="layui-inline">
                    <select name="atype" id="atype" lay-filter="atype">
                    </select>
                </div>

                使用情况：
                <div class="layui-inline">
                    <select name="astate" id="astate" lay-filter="astate">
                    </select>
                </div>

                购买时间：
                <div class="layui-inline">
                    <input type="text" class="layui-input" name="buytime" id="buytime" placeholder="yyyy-MM-dd HH:mm:ss">
                </div>

                <button title="搜索" type="button" style="background-color: #675eea;" class="layui-btn" lay-submit="" lay-filter="search"><i class="layui-icon">&#xe615;</i></button>
            </form>
        </div>

        <div style="">
            <table class="layui-table" id="detailTb" lay-filter="detailTb"></table>
        </div>
    </div>
</body>
<script src="/static/js/jquery-1.11.3.min.js"></script>
<script src="/static/layui.js"></script>
<script src="/static/js/c-component.js"></script>

<!--表格的操作事件-->
<script type="text/html" id="barDemo">
    <a class="layui-btn layui-btn-xs" lay-event="details">详情</a>
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
</script>

<script>

    $(function () {
       getStateAndType();
    });

    //查询使用情况和类型：
    function getStateAndType(){
        layui.use('form', function() {
            var form = layui.form;
            var typeList = "", stateList = "";
            $.ajax({
                type: 'get',
                url: '/details/queryStateAndType',
                async:false,
                success: function (data) {
                    typeList = data.types;
                    stateList = data.states;
                }
            });

            if (typeList.length>0 && typeList!=null){
                var str = "<option value=\"\">请选择</option>";
                for (var i=0; i<typeList.length; i++){
                    str += "<option value=\""+typeList[i].assetsTypeName+"\">"+typeList[i].assetsTypeName+"</option>";
                }
                $("#atype").html(str);
            }

            if (stateList.length>0 && stateList!=null){
                var str = "<option value=\"\">请选择</option>";
                for (var i=0; i<stateList.length; i++){
                    str += "<option value=\""+stateList[i].stateId+"\">"+stateList[i].stateName+"</option>";
                }
                $("#astate").html(str);
            }
            form.render('select');

        });
    }

    layui.use(['table','laydate', 'form'], function(){
        var table = layui.table;
        var laydate = layui.laydate;
        var form = layui.form;

        //时间样式：
        laydate.render({
            elem: '#buytime',
            type: 'datetime'
        });
        table.render({
            elem: '#detailTb'
            ,limit:10
            ,url:'/details/assetsDet'
            ,page:true
            ,response: {
                statusName: 'responseCode',
                statusCode: 200,
                msgName: 'responseDesc',
                countName: 'total'
             }
            ,cols: [[
                {field:'assetsId', width:'10%', title: '资产编号', sort: true}
                ,{field:'assetsName', width:'10%', title: '资产名称'}
                ,{field:'assetsBuytime', title: '购买时间', sort: true, width:'15%'}
                ,{field:'assetsNum', width:'5%', title: '数量', sort: true}
                ,{field:'assetInitialval', title: '资产原值', sort: true, width:'10%'}
                ,{field:'exceptNetval', title: '预计净残值', width:'10%'}
                ,{field:'assetsType', title: '资产类型', width: '10%'}
                ,{field:'deptUse', width:'10%', title: '使用部门'}
                ,{field:'assetsStateName', width:'10%', title: '使用情况', templet: function(d){
                    var color = "";
                    var state = d.assetsStateName;
                    switch (state){
                        case "使用中":
                            color = "#5551b8";
                            break;
                        case "出售":
                            color = "#bababc";
                            break;
                        case "已借出":
                            color = "#ff9d22";
                            break;
                        default:
                            color = "#8ecbff";
                            break;
                    }

                    var dhtml =
                        "<li style=\"text-align: center; color:"+color+";\">" +
                        "<a href='javascript:void(0)'  style='color:"+color+" '>·"+state+"</a>" +
                        "</li>  " ;
                    return dhtml;
                }}
                ,{fixed: 'right', title:'操作', toolbar: '#barDemo',width: '10%'}
            ]]
        });

        //监听行的操作事件：
        table.on('tool(detailTb)', function(obj){
            var data = obj.data;
            if(obj.event === 'del'){
                layer.confirm('真的删除行么', function(index){
                    obj.del();
                    layer.close(index);
                });
            } else if(obj.event === 'details'){
                //详情
                layer.open({ //弹出新建业务模板类型的弹窗；
                    type:1,
                    area:['1100px','600px'],
                    title:"资产详情",
                    // btn:['确定','取消'],
                    success: function(layero, index){ //弹窗打开的发生的事件
                        for (var k in data){
                            var str = "#tdetail #"+k;
                            $(str).val(data[k]);
                        }
                        $("#detailsWindow").show();
                    },
                    yes:function (index,layero) {
                        layer.close(index);
                    },
                    btn2:function (index,layero) {
                    },
                    content:$("#detailsWindow"),
                    end: function (){
                        $("#detailsWindow").hide();
                    }
                });


            }
        });

        // 搜索条件表单监听
        form.on('submit(search)', function (data) {
            var serchDatas = data.field;// data.field获取整个表单
            table.reload('detailTb', {where: serchDatas});
        });

    });
</script>
</html>